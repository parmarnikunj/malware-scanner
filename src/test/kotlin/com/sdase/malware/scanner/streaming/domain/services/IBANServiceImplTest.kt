package com.sdase.malware.scanner.streaming.domain.services

import com.sdase.malware.scanner.streaming.domain.repositories.IBANRepository
import io.mockk.mockk
import io.mockk.verify
import org.assertj.core.api.Assertions.assertThat
import org.junit.jupiter.api.Test

class IBANServiceImplTest {

    private val ibanRepository = mockk<IBANRepository>(relaxed = true)

    private val IBANService = IBANServiceImpl(ibanRepository)
    @Test
    fun `returns false if IBAN is in the blacklist`() {
        val iban = "DE15 3006 0601 0505 7807 80"

        val isIBANBlacklisted = IBANService.isBlacklisted(iban)

        verify { ibanRepository.isInBlacklist(any()) }

        assertThat(isIBANBlacklisted).isFalse()
    }
}