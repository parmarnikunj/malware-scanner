package com.sdase.malware.scanner.streaming.domain.services

import com.sdase.malware.scanner.streaming.domain.model.CheckEvent
import org.slf4j.Logger
import org.springframework.kafka.annotation.KafkaListener
import org.springframework.stereotype.Service

@Service
class ListenerServiceImpl(
    private val scannerService: ScannerService,
    private val logger: Logger
): ListenerService {

    @KafkaListener(id = "myId", topics = ["scan_malware"])
    override fun listen(checkEvent: CheckEvent?) {
        logger.info("event received : $checkEvent")
        val checkResultEvent = scannerService.scan(checkEvent)
    }
}