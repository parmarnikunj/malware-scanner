package com.sdase.malware.scanner.streaming.domain.services

import com.sdase.malware.scanner.streaming.domain.model.CheckResultEvent
import com.sdase.malware.scanner.streaming.domain.model.DocumentCheck
import com.sdase.malware.scanner.streaming.domain.model.EventDetails
import com.sdase.malware.scanner.streaming.domain.model.StateEnum
import org.springframework.stereotype.Service

@Service
class EventFactory {
    fun createEvent(eventDetails: EventDetails): CheckResultEvent {
        return CheckResultEvent(
            extractState(eventDetails.documentCheck),
            eventDetails.name,
            eventDetails.details)
    }

    private fun extractState(documentCheck: DocumentCheck): StateEnum {
        if(documentCheck.isBlacklisted){
            return StateEnum.ERROR
        }
        return StateEnum.OK
    }

}